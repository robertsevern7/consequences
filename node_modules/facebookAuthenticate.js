function authenticate(req, res, callback) {
    if (req.body.accessToken) {
        var HTTPS = require("https");
        
        var request = HTTPS.request({
            'method': 'GET',
            'host': 'graph.facebook.com',
            'port': 443,
            'path': 'https://graph.facebook.com/me/?access_token='+req.body.accessToken
        }, function (res) {
            var data = '';
            res.setEncoding('utf8');
            res.on('data', function (chunk) {
                data += chunk;
            });
            res.on('end', function () {
                try {
                    var result = JSON.parse(data);
                    callback(result.error || null, result.data || result);
                } catch (err) {
                    console.dir(err)
                    callback('Error', data || null);
                }
            });
        });
        request.end(); 
    }
}

function getFriends(req, res, callback) {
    if (req.body.accessToken) {
        var HTTPS = require("https");
       
        var request = HTTPS.request({
            'method': 'GET',
            'host': 'graph.facebook.com',
            'port': 443,
            'path': 'https://graph.facebook.com/me/friends?access_token='+req.body.accessToken
        }, function (res) {
            var data = '';
            res.setEncoding('utf8');
            res.on('data', function (chunk) {
                data += chunk;
            });
            res.on('end', function () {
                try {
                    var result = JSON.parse(data);
                    callback(result.error || null, result.data || result);
                } catch (err) {
                    console.dir(err)
                    callback('Error', data || null);
                }
            });
        });
        request.end(); 
    }
}

module.exports.authenticate = authenticate;
module.exports.getFriends = getFriends;